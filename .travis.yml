language: scala

sudo: false

scala:
- 2.11.12
- 2.12.12
- 2.13.3

jdk:
  - openjdk8

cache:
  directories:
    - $HOME/.ivy2/cache
    - $HOME/.sbt/launchers
    - $HOME/.cache/coursier

script:
  - git config core.whitespace tab-in-indent,trailing-space,space-before-tab,cr-at-eol
  - git show --oneline --check
  - wget https://raw.githubusercontent.com/paulp/sbt-extras/acb9803ff66ebdcf6ad7d08661398b35382ebab9/sbt && chmod +x ./sbt
  - ./sbt ++${TRAVIS_SCALA_VERSION} scalafmtCheck test:scalafmtCheck scalafmtSbtCheck update compile test:compile test publishLocal

before_cache:
  - find $HOME/.ivy2/cache -name "ivydata-*.properties" | xargs rm
  - find $HOME/.ivy2/cache -name "*SNAPSHOT*" | xargs rm -rf

matrix:
  include:
    - scala: 2.12.12
      jdk: openjdk11
    - scala: 0.27.0-RC1
      script:
       - sbt "++${TRAVIS_SCALA_VERSION}!" scalafmtCheck test:scalafmtCheck scalafmtSbtCheck msgpack4zNativeJVM/test msgpack4zNativeJVM/publishLocal
    - scala: 2.11.12
      sudo: required
      before_install:
      - curl https://raw.githubusercontent.com/scala-native/scala-native/master/scripts/travis_setup.sh | bash -x
      - wget https://raw.githubusercontent.com/paulp/sbt-extras/acb9803ff66ebdcf6ad7d08661398b35382ebab9/sbt && chmod +x ./sbt
      script:
      - ./sbt ++$TRAVIS_SCALA_VERSION msgpack4zNativeNative/test
